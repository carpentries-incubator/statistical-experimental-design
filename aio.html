<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Statistical Experimental Design: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="assets/styles.css">
<script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="manifest" href="site.webmanifest">
<link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav carpentries"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="The Carpentries" src="assets/images/carpentries-logo.svg"><abbr class="badge badge-light" title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught." style="background-color: #FF4955; border-radius: 5px">
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link" style="color: #000">
            <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
            Pre-Alpha
          </a>
          <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/aio.html';">Instructor View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav carpentries" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="The Carpentries" src="assets/images/carpentries-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Statistical Experimental Design
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Statistical Experimental Design
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<li><a class="dropdown-item" href="discuss.html">Discussion</a></li>
<li><a class="dropdown-item" href="reference.html">Glossary</a></li>
          </ul>
</li>
      </ul>
</div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
<input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset>
</form>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Statistical Experimental Design
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress carpentries">
    <div class="progress-bar carpentries" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/aio.html">Instructor View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->
      
            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-introduction.html">1. Introduction</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-experimental-structure.html">2. Essential Features of a Comparative Experiment</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-design-principles.html">3. Experimental Design Principles</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-statistical-data-analysis.html">4. Statistics in Data Analysis</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-complete-random-design.html">5. Completely Randomized Designs</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-complete-random-design-multitreatment-factors.html">6. Completely Randomized Design with More than One Treatment Factor</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="07-complete-random-block.html">7. Randomized Complete Block Designs</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="08-repeated-measures-design.html">8. Repeated Measures Designs</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="discuss.html">Discussion</a></li>
<li><a href="reference.html">Glossary</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">
            
            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-01-introduction"><p>Content from <a href="01-introduction.html">Introduction</a></p>
<hr>
<p>Last updated on 2024-04-02 |
        
        <a href="https://github.com/smcclatchy/statistical-experimental-design/edit/main/episodes/01-introduction.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is gained from good experimental design?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Connect experimental design with data quality and meaningful
findings.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Good experimental design generates information-rich data with a clear
message. In both scientific research and industry, experimental design
plays a critical role in obtaining reliable and meaningful results.
Scientists can better understand their work when they carry out
well-conceived, well-executed experiments and then extract, communicate,
and act on information generated in those experiments. This course will
prepare scientists to design rigorous experiments that generate
high-value data and to extract and communicate its messages. By applying
statistical concepts in designing experiments, understanding
variability, and drawing meaningful inferences, participants will be
equipped with the knowledge and skills for data-driven
decision-making.</p>
<p>Experimental design aims to describe and explain variation in natural
systems by intervening to affect that variation directly. For example,
the Salk polio vaccine trials collected data about variation in polio
incidence after injecting more than 600,000 schoolchildren with vaccine
or placebo. This clinical trial hypothesized that the vaccine would
reduce the incidence of polio in schoolchildren. More than a million
additional children were vaccinated and served as observed controls. The
results showed evidence that the vaccine was 80-90% effective in
preventing polio.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Good experimental design generates information-rich data with a
clear message.</li>
</ul>
</div>
</div>
</div></section><section id="aio-02-experimental-structure"><p>Content from <a href="02-experimental-structure.html">Essential Features of a Comparative Experiment</a></p>
<hr>
<p>Last updated on 2024-04-02 |
        
        <a href="https://github.com/smcclatchy/statistical-experimental-design/edit/main/episodes/02-experimental-structure.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How are comparative experiments structured?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe the common features of comparative experiments.</li>
<li>Identify experimental units, treatments, response measurements,
ancillary and nuisance variables</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>The <a href="https://bmjopen.bmj.com/content/5/2/e007519" class="external-link">Generation
100 study</a> evaluated the effects of exercise on more than 1500
elderly Norwegians from Trondheim, Norway, to determine if exercise led
to a longer active and healthy life. Specifically the researchers
investigated the relationship between exercise intensity and health and
longevity. One group performed high-intensity interval training (10
minute warm-up followed by four 4-minute intervals at ∼90% of peak heart
rate) twice a week for five years. A second group performed moderate
exercise twice a week (50 minutes of continuous exercise at ∼70% of peak
heart rate). A third control group followed physical activity advice
according to national recommendations. Clinical examinations and
questionnaires were administered to all at the start and after one,
three, and five years. Heart rate, blood pressure, leg and grip
strength, cognitive function, and other health indicators were measured
during clinical exams.</p>
<div id="challenge-1-raw-ingredients-of-a-comparative-experiment" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1-raw-ingredients-of-a-comparative-experiment" class="callout-inner">
<h3 class="callout-title">Challenge 1: Raw ingredients of a comparative
experiment<a class="anchor" aria-label="anchor" href="#challenge-1-raw-ingredients-of-a-comparative-experiment"></a>
</h3>
<div class="callout-content">
<p>Discuss the following questions with your partner, then share your
answers to each question in the collaborative document.</p>
<ol style="list-style-type: decimal">
<li>What is the research question in this study? If you prefer to name a
hypothesis, turn the research question into a declarative
statement.</li>
<li>What is the treatment (treatment factor)? How many levels are there
for this treatment factor?</li>
<li>What are the experimental units (the entities to which treatments
are applied)?</li>
<li>What are the responses (the measurements used to determine treatment
effects)?</li>
<li>Should participants have been allowed to choose which group
(high-intensity, moderate exercise, or national standard) they wanted to
join? Why or why not? Should the experimenters have assigned
participants to treatment groups based on their judgment of each
participant’s characteristics? Why or why not?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>The research question asked whether exercise, specifically
high-intensity exercise, would affect healthspan and lifespan of elderly
Norwegians. The treatments were high-intensity, moderate-intensity, and
national standard exercise groups. The experimental units are the
individuals. The responses measured were heart rate, blood pressure,
strength, cognitive function and other health indicators. The main
response measured was 5-year survival. If participants had been allowed
to choose their preferred exercise group or if experimenters had chosen
the groups based on participant characteristics, extraneous variables
(e.g. state of depression or anxiety) could be introduced into the
study. When participants are randomly assigned to treatment groups,
these variables are spread across the groups and cancel out.
Furthermore, if experimenters had used their own judgment to assign
participants to groups, their own biases could have affected the
results.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="conducting-a-comparative-experiment">Conducting a Comparative Experiment<a class="anchor" aria-label="anchor" href="#conducting-a-comparative-experiment"></a>
</h3>
<p>Comparative experiments apply treatments to experimental units and
measure the responses, then compare the responses to those treatments
with statistical analysis. If in the Generation 100 study the
experimenters had only one group (e.g. high-intensity training), they
might have achieved good results but would have no way of knowing if
either of the other treatments would have achieved the same or even
better results. To know whether high-intensity training is better than
moderate or low-intensity training, it was necessary to run experiments
in which some experimental units engaged in high-intensity training,
others in moderate, and others still in low-intensity training. Only
then can the responses to those treatments be statistically analyzed to
determine treatment effects.</p>
<div id="challenge-2-which-are-the-experimental-units" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2-which-are-the-experimental-units" class="callout-inner">
<h3 class="callout-title">Challenge 2: Which are the experimental
units?<a class="anchor" aria-label="anchor" href="#challenge-2-which-are-the-experimental-units"></a>
</h3>
<div class="callout-content">
<p>Identify the experimental units in each experiment described below,
then share your answers in the collaborative document.</p>
<ol style="list-style-type: decimal">
<li>Three hundred mice are individually housed in the same room. Half of
them are fed a high-fat diet and the other half are fed regular
chow.</li>
<li>Three hundred mice are housed five per cage in the same room. Half
of them are fed a high-fat diet and the other half are fed regular
chow.</li>
<li>Three hundred mice are individually housed in two different rooms.
Those in the first room are fed a high-fat diet and those in the other
room are fed regular chow.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li><p>The individual animal is the experimental unit.</p></li>
<li><p>The cage receives the treatment and is the experimental
unit.</p></li>
<li><p>The room receives the treatment and is the experimental
unit.</p></li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="reducing-bias-with-randomization-and-blinding">Reducing Bias with Randomization and Blinding<a class="anchor" aria-label="anchor" href="#reducing-bias-with-randomization-and-blinding"></a>
</h3>
<p>Randomized studies assign experimental units to treatment groups
randomly by pulling a number out of a hat or using a computer’s random
number generator. The main purpose for <em>randomization</em> comes
later during statistical analysis, where we compare the data we have
with the data distribution we might have obtained by random chance.
Randomization provides us a way to create the distribution of data we
might have obtained and ensures that our comparisons between treatment
groups are valid. Random assignment (<em>allocation</em>) of
experimental units to treatment groups prevents the subjective bias that
might be introduced by an experimenter who selects, even in good faith
and with good intention, which experimental units should get which
treatment. For example, if the experimenter selected which people would
do high-, moderate- and low-intensity training they might unconsciously
bias the groups by body size or shape. This <em>selection bias</em>
would influence the outcome of the experiment.</p>
<p>Randomization also accounts for or cancels out effects of “nuisance”
variables like the time or day of the experiment, the investigator or
technician, equipment calibration, exposure to light or ventilation in
animal rooms, or other variables that are not being studied but that do
influence the responses. Randomization balances out the effects of
nuisance variables between treatment groups by giving an equal
probability for an experimental unit to be assigned to any treatment
group.</p>
<p><em>Blinding</em> (also known as masking) prevents the experimenter
from influencing the outcome of an experiment to suit their expectations
or preferred hypothesis. Ideally experimenters should not know which
treatment the experimental units have received or will receive from the
beginning through to the statistical analysis stage of the experiment.
This might require additional personnel like technicians or other
colleagues to perform some tasks, and should be planned during
experimental design. If ideal circumstances can’t be arranged, it should
be possible to carry out at least some of the stages blind. Blinding
during allocation (assignment of experimental units to treatment
groups), treatment, data collection or data analysis can reduce
experimental bias.</p>
<div id="challenge-3-how-does-bias-enter-an-experiment" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-3-how-does-bias-enter-an-experiment" class="callout-inner">
<h3 class="callout-title">Challenge 3: How does bias enter an
experiment?<a class="anchor" aria-label="anchor" href="#challenge-3-how-does-bias-enter-an-experiment"></a>
</h3>
<div class="callout-content">
<p>Identify ways that bias enters into each experiment described below,
then share your answers in the collaborative document.</p>
<ol style="list-style-type: decimal">
<li>A clinician perceives increased aggression in subjects given
testosterone.</li>
<li>A clinician concludes that mood of each subject has improved in the
treatment group given a new antidepressant.</li>
<li>A researcher unintentionally treats subjects differently based on
their treatment group by providing more food to control group
animals.</li>
<li>A clinician gives different nonverbal cues to patients in the
treatment group of a clinical trial than to the control group
patients.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Show me the solution</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>1 and 2 describe nonblind data collection reporting increased
treatment effects. Inflated effect sizes are a common problem with
nonblinded studies. In 3 and 4 the experimenter</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>The raw ingredients of comparative experiments are experimental
units, treatments and responses.</li>
</ul>
</div>
</div>
</div>
</div></section><section id="aio-03-design-principles"><p>Content from <a href="03-design-principles.html">Experimental Design Principles</a></p>
<hr>
<p>Last updated on 2024-04-04 |
        
        <a href="https://github.com/smcclatchy/statistical-experimental-design/edit/main/episodes/03-design-principles.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are the core principles of experimental design?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>The way in which a design applies treatments to experimental units
and measures the responses will determine 1) what questions can be
answered and 2) with what precision relationships can be described.</li>
<li>The core principles guiding the way are 1) replication, 2)
randomization and 3) blocking.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Variability is natural in the real world. A medication given to a
group of patients will affect each of them differently. A specific diet
given to a cage of mice will affect each mouse differently. Ideally if
something is measured many times, each measurement will give exactly the
same result and will represent the true value. This ideal doesn’t exist
in the real world. For example, the mass of one kilogram is defined by
the <a href="https://en.wikipedia.org/wiki/International_Prototype_of_the_Kilogram" class="external-link">International
Prototype Kilogram</a>, a cylinder composed of platinum and iridium
about the size of a golf ball.</p>
<figure><img src="fig/International_prototype_of_the_kilogram_aka_Le_Grand_K.png" alt="International Prototype of the Kilogram" class="figure mx-auto d-block"></figure><p>Copies of this prototype kilogram (replicates) are distributed
worldwide so each country hosting a replica has its own national
standard kilogram. None of the replicas measure precisely the same
despite careful storage and handling. The reasons for this variation in
measurements are not known. A kilogram in Austria differs from a
kilogram in Australia, which differs from that in Brazil, Kazakhstan,
Pakistan, Switzerland or the U.S. What we assume is an absolute measure
of mass shows real-world natural variability. Variability is a feature
of natural systems and also a natural part of every experiment we
undertake.</p>
<section id="replication-to-characterize-variability"><h2 class="section-heading">Replication to characterize variability<a class="anchor" aria-label="anchor" href="#replication-to-characterize-variability"></a>
</h2>
<hr class="half-width">
<p>To figure out whether a difference in responses is real or inherently
random, <strong>replication</strong> applies the same treatment to
multiple experimental units. The variability of the responses within a
set of replicates provides a measure against which we can compare
differences among different treatments. This variability is known as
<strong>experimental error</strong>. This does not mean that something
was done wrongly! It’s a phrase describing the variability in the
responses. Random variation is also known as <strong>random
error</strong> or <strong>noise</strong>. It reflects imprecision, but
not inaccuracy. Larger sample sizes reduce this imprecision.</p>
<p>In addition to random (experimental) error, also known as noise,
there are two other sources of variability in experiments.
<strong>Systematic error</strong> or bias, occurs when there are
deviations in measurements or observations that are consistently in one
particular direction, either overestimating or underestimating the true
value. As an example, a scale might be calibrated so that mass
measurements are consistently too high or too low. Unlike random error,
systematic error is consistent in one direction, is predictable and
follows a pattern. Larger sample sizes don’t correct for systematic
bias; equipment or measurement calibration does. <strong>Technical
replicates</strong> define this systematic bias by running the same
sample through the machine or measurement protocol multiple times to
characterize the variation caused by equipment or protocols.</p>
<p>A <strong>biological replicate</strong> measures different biological
samples in parallel to estimate the variation caused by the unique
biology of the samples. The sample or group of samples are derived from
the same biological source, such as cells, tissues, organisms, or
individuals. Biological replicates assess the variability and
reproducibility of experimental results. For example, if a study
examines the effect of a drug on cell growth, biological replicates
would involve multiple samples from the same cell line to test the
drug’s effects. This helps to ensure that any observed changes are due
to the drug itself rather than variations in the biological material
being used.</p>
<p>The greater the number of biological replicates, the greater the
precision (the closeness of two or more measurements to each other).
Having a large enough sample size to ensure high precision is necessary
to ensure reproducible results. Note that increasing the number of
technical replicates will not help to characterize biological
variability! It is used to characterize systematic error, not
experimental error.</p>
<div id="exercise-1-which-kind-of-error" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1-which-kind-of-error" class="callout-inner">
<h3 class="callout-title">Exercise 1: Which kind of error?<a class="anchor" aria-label="anchor" href="#exercise-1-which-kind-of-error"></a>
</h3>
<div class="callout-content">
<p>A study used to determine the effect of a drug on weight loss could
have the following sources of experimental error. Classify the following
sources as either biological, systematic, or random error.<br>
1). A scale is broken and provides inconsistent readings.<br>
2). A scale is calibrated wrongly and consistently measures mice 1 gram
heavier.<br>
3). A mouse has an unusually high weight compared to its experimental
group (i.e., it is an outlier).<br>
4). Strong atmospheric low pressure and accompanying storms affect
instrument readings, animal behavior, and indoor relative humidity.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Solution to Exercise 1</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>1). random, because the scale is broken and provides any kind of
random reading it comes up with (inconsistent reading)<br>
2). systematic<br>
3). biological<br>
4). random or systematic; you argue which and explain why</p>
</div>
</div>
</div>
</div>
<p>These three sources of error can be mitigated by good experimental
design. Systematic and biological error can be mitigated through
adequate numbers of technical and biological replicates, respectively.
Random error can also be mitigated by experimental design, however,
replicates are not effective. By definition random error is
unpredictable or unknowable. For example, an atmospheric low pressure
system or a strong storm could affect equipment measurements, animal
behavior, and indoor relative humidity, which introduces random error.
We could assume that all random error will balance itself out, and that
all samples will be equally subject to random error. A more precise way
to mitigate random error is through blocking.</p>
<div id="exercise-2-how-many-technical-and-biological-replicates" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-2-how-many-technical-and-biological-replicates" class="callout-inner">
<h3 class="callout-title">Exercise 2: How many technical and biological
replicates?<a class="anchor" aria-label="anchor" href="#exercise-2-how-many-technical-and-biological-replicates"></a>
</h3>
<div class="callout-content">
<p>In each scenario described below, identify how many technical and how
many biological replicates are represented. What conclusions can be
drawn about experimental error in each scenario?</p>
<p>1). One person is weighed on a scale five times.<br>
2). Five people are weighed on a scale one time each.<br>
3). Five people are weighed on a scale three times each.<br>
4). A cell line is equally divided into four samples. Two samples
receive a drug treatment, and the other two samples receive a different
treatment. The response of each sample is measured three times to
produce twelve total observations. In addition to the number of
replicates, can you identify how many experimental units there
are?<br>
5). A cell line is equally divided into two samples. One sample receives
a drug treatment, and the other sample receives a different treatment.
Each sample is then further divided into two subsamples, each of which
is measured three times to produce twelve total observations. In
addition to the number of replicates, can you identify how many
experimental units there are?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Solution to Exercise 2</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>1). One biological sample (not replicated) with five technical
replicates. The only conclusion to be drawn from the measurements would
be better characterization of systematic error in measuring. It would
help to describe variation produced by the instrument itself, the scale.
The measurements would not generalize to other people.<br>
2). Five biological replicates with one technical measurement (not
replicated). The conclusion would be a single snapshot of the weight of
each person, which would not capture systematic error or variation in
measurement of the scale. There are five biological replicates, which
would increase precision, however, there is considerable other variation
that is unaccounted for.<br>
3). Five biological replicates with three technical replicates each. The
three technical replicates would help to characterize systematic error,
while the five biological replicates would help to characterize
biological variability.<br>
4). Four biological replicates with three technical replicates each. The
three technical replicates would help to characterize systematic error,
while the four biological replicates would help to characterize
biological variability. Since the treatments are applied to each of the
four samples, there are four experimental units.<br>
5). Two biological replicates with three technical replicates each.
Since the treatments are applied to only the two original samples, there
are only two experimental units.</p>
</div>
</div>
</div>
</div>
</section><section id="randomization"><h2 class="section-heading">Randomization<a class="anchor" aria-label="anchor" href="#randomization"></a>
</h2>
<hr class="half-width">
<div id="exercise-3-the-efficient-technician" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-3-the-efficient-technician" class="callout-inner">
<h3 class="callout-title">Exercise 3: The efficient technician<a class="anchor" aria-label="anchor" href="#exercise-3-the-efficient-technician"></a>
</h3>
<div class="callout-content">
<p>Your technician colleague finds a way to simplify and expedite an
experiment. The experiment applies four different wheel-running
treatments to twenty different mice over the course of five days. Four
mice are treated individually each day for two hours each with a random
selection of the four treatments. Your clever colleague decides that a
simplified protocol would work just as well and save time. Run treatment
1 five times on day 1, treatment 2 five times on day 2, and so on. Some
overtime would be required each day but the experiment would be
completed in only four days, and then they can take Friday off! Does
this adjustment make sense to you?<br>
Can you foresee any problems with the experimental results?</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Solution to Exercise 3</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>Since each treatment is run on only one day, the day effectively
becomes the experimental unit (explain this). Each experimental unit
(day) has five samples (mice), but only one replication of each
treatment. There is no valid way to compare treatments as a result.
There is no way to separate the treatment effect from the day-to-day
differences in environment, equipment setup, personnel, and other
extraneous variables.</p>
</div>
</div>
</div>
</div>
<p>Why should treatments be randomly assigned to experimental units?
Randomization minimizes bias and moderates experimental error (a.k.a.
noise). A hat full of numbers, a random number table or a computational
random number generator can be used to assign random numbers to
experimental units so that any experimental unit has equal chances of
being assigned to a specific treatment group.</p>
<p>Here is an example of randomization using a random number generator.
The study asks how a high-fat diet affects blood pressure in mice. If
the random number is odd, the sample is assigned to the treatment group,
which receives the high-fat diet. If the random number is even, the
sample is assigned to the control group (the group that doesn’t receive
the treatment, in this case, regular chow).</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create the mouse IDs and 26 random numbers between 1 and 100</span></span>
<span><span class="va">mouse_ID</span> <span class="op">&lt;-</span> <span class="va">LETTERS</span></span>
<span><span class="va">random_number</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">100</span>, size <span class="op">=</span> <span class="fl">26</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># %% is the modulo operator, which returns the remainder from division by 2</span></span>
<span><span class="co"># if the remainder is 0 (even number), regular chow diet is assigned</span></span>
<span><span class="co"># if not, high fat is assigned</span></span>
<span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu">ifelse</span><span class="op">(</span><span class="va">random_number</span> <span class="op">%%</span> <span class="fl">2</span> <span class="op">==</span> <span class="fl">0</span>, <span class="st">"chow"</span>, <span class="st">"high fat"</span><span class="op">)</span></span>
<span><span class="va">random_allocation</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">mouse_ID</span>, <span class="va">random_number</span>, <span class="va">treatment</span><span class="op">)</span></span>
<span><span class="va">random_allocation</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   mouse_ID random_number treatment
1         A            13  high fat
2         B            54      chow
3         C            27  high fat
4         D            79  high fat
5         E            31  high fat
6         F            12      chow
7         G            69  high fat
8         H            15  high fat
9         I            23  high fat
10        J            25  high fat
11        K            42      chow
12        L             4      chow
13        M            22      chow
14        N            76      chow
15        O            28      chow
16        P             7  high fat
17        Q            89  high fat
18        R            14      chow
19        S            39  high fat
20        T            84      chow
21        U            67  high fat
22        V            94      chow
23        W            85  high fat
24        X             5  high fat
25        Y            93  high fat
26        Z             3  high fat</code></pre>
</div>
<p>This might produce unequal numbers between treatment and control
groups. It isn’t necessary to have equal numbers, however,
<strong>sensitivity</strong> or <strong>statistical power</strong> (the
probability of detecting an effect when it truly exists) is maximized
when sample numbers are equal.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">table</span><span class="op">(</span><span class="va">random_allocation</span><span class="op">$</span><span class="va">treatment</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
    chow high fat 
      10       16 </code></pre>
</div>
<p>To randomly assign samples to groups with equal numbers, you can do
the following.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># place IDs and random numbers in data frame</span></span>
<span><span class="va">equal_allocation</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">mouse_ID</span>, <span class="va">random_number</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># sort by random numbers (not by sample IDs)</span></span>
<span><span class="va">equal_allocation</span> <span class="op">&lt;-</span> <span class="va">equal_allocation</span><span class="op">[</span><span class="fu">order</span><span class="op">(</span><span class="va">random_number</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co"># now assign to treatment or control groups</span></span>
<span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu">sort</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span>x <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"chow"</span>, <span class="st">"high fat"</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">13</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">equal_allocation</span> <span class="op">&lt;-</span> <span class="fu">cbind</span><span class="op">(</span><span class="va">equal_allocation</span>, <span class="va">treatment</span><span class="op">)</span></span>
<span><span class="fu">row.names</span><span class="op">(</span><span class="va">equal_allocation</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">26</span></span>
<span><span class="va">equal_allocation</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   mouse_ID random_number treatment
1         Z             3      chow
2         L             4      chow
3         X             5      chow
4         P             7      chow
5         F            12      chow
6         A            13      chow
7         R            14      chow
8         H            15      chow
9         M            22      chow
10        I            23      chow
11        J            25      chow
12        C            27      chow
13        O            28      chow
14        E            31  high fat
15        S            39  high fat
16        K            42  high fat
17        B            54  high fat
18        U            67  high fat
19        G            69  high fat
20        N            76  high fat
21        D            79  high fat
22        T            84  high fat
23        W            85  high fat
24        Q            89  high fat
25        Y            93  high fat
26        V            94  high fat</code></pre>
</div>
<p>You can write out this treatment plan to a comma-separated values
(csv) file, then open it in Excel and use it to record your data
collection or just keep track of which samples are randomly assigned
which diet.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">write.csv</span><span class="op">(</span><span class="va">equal_allocation</span>, file <span class="op">=</span> <span class="st">"./data/random-assign.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<div id="discussion" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="discussion" class="callout-inner">
<h3 class="callout-title">Discussion<a class="anchor" aria-label="anchor" href="#discussion"></a>
</h3>
<div class="callout-content">
<p>Why not assign treatment and control groups to samples in
alphabetical order?<br>
Did we really need a random number generator to obtain randomized equal
groups?</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">Show me the solution</h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<p>1). Scenario: One technician processed samples A through M, and a
different technician processed samples N through Z. Might the first
technician have processed samples somewhat differently from the second
technician? If so, there would be a “technician effect” in the results
that would be difficult to separate from the treatment effect. 2).
Another scenario: Samples A through M were processed on a Monday, and
samples N through Z on a Tuesday. Might the weather or the environment
in general have been different between Monday and Tuesday? What if a big
construction project started on Tuesday, or the whole team had a
birthday gathering for one of their members, or anything else in the
environment differed between Monday and Tuesday? If so, there would be a
“day-of-the-week effect” in the results that would be difficult to
separate from the treatment effect. 3). Yet another scenario: Samples A
through M were from one strain, and samples N through Z from a different
strain. How would you be able to distinguish between the treatment
effect and the strain effect? 4). Yet another scenario: Samples with
consecutive ids were all sibling groups. For example, samples A, B and C
were all siblings, and all assigned to the same treatment.<br>
All of these cases would have introduced an effect (from the technician,
the day of the week, the strain, or sibling relationships) that would
confound the results and lead to misinterpretation.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="controlling-natural-variation-with-blocking">Controlling Natural Variation with Blocking<a class="anchor" aria-label="anchor" href="#controlling-natural-variation-with-blocking"></a>
</h3>
<p>Experimental units can be grouped, or <strong>blocked</strong>, to
increase the precision of treatment comparisons. Blocking divides an
experiment into groups of experimental units to control natural
variation among these units. Treatments are randomized to experimental
units within each block. Each block, then, is effectively a
sub-experiment.</p>
<p>Randomization within blocks accounts for nuisance variables that
could bias the results, such as day, time, cage proximity to light or
ventilation, etc. In the illustration below, three treatments are
randomized to the experimental units (the cages) on each shelf. Each
shelf is a block that accounts for random variation introduced by a
nuisance variable, proximity to the light.</p>
<figure><img src="fig/half-racks.png" alt="shelves of cages beneath a light" class="figure mx-auto d-block"></figure><p>Shelf height is a <strong>blocking factor</strong> that should be
included in the data analysis phase of the experiment. Adding a nuisance
variable as a blocking factor accounts for variability and can increase
the probability of detecting a real treatment effect
(<strong>statistical power</strong>). If the blocking factor doesn’t
substantially impact variability, however, it reduces the information
used to estimate a statistic (<strong>degrees of freedom</strong>) and
diminishes statistical power. Blocking should only be used when a
variable is suspected to impact the experiment.</p>
<p>Another way to define blocks of experimental units is to use
characteristics or traits that are likely associated with the response.
Sex and age, for example, can serve as blocking factors in experiments,
with experimental units randomly allocated to each block based on age
category and sex. <em>Stratified randomization</em> places experimental
units into separate blocks for each age category and sex. As with
nuisance variables, these blocking factors (age and sex) should be used
in the subsequent data analysis.</p>
<div id="exercise-3-explain-blocking-to-the-efficient-technician" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-3-explain-blocking-to-the-efficient-technician" class="callout-inner">
<h3 class="callout-title">Exercise 3: Explain blocking to the efficient
technician<a class="anchor" aria-label="anchor" href="#exercise-3-explain-blocking-to-the-efficient-technician"></a>
</h3>
<div class="callout-content">
<p>Your technician colleague is not only efficient but very
well-organized. They will administer treatments A, B and C shown in the
figure above.</p>
<ol style="list-style-type: decimal">
<li>Explain to your colleague why the treatments should not be
administered by shelf (e.g. the top shelf all get treatment A, the next
shelf B and the lower shelf treatment C).</li>
<li>Explain blocking to the technician and describe how it helps the
experiment.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">Solution to Exercise 3</h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">

</div>
</div>
</div>
</div>
<div id="exercise-4-how-and-when-to-set-up-blocks" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-4-how-and-when-to-set-up-blocks" class="callout-inner">
<h3 class="callout-title">Exercise 4: How and when to set up blocks<a class="anchor" aria-label="anchor" href="#exercise-4-how-and-when-to-set-up-blocks"></a>
</h3>
<div class="callout-content">
<p>For the following scenarios, describe whether you would set up blocks
and if so, how you would set up the blocks.</p>
<ol style="list-style-type: decimal">
<li>A large gene expression study will be run in five different batches
or runs.</li>
<li>An experiment will use two different models of equipment to obtain
measurements.</li>
<li>Samples will be processed in the morning, afternoon and
evening.</li>
<li>In a study in which mice were randomly assigned to treatment and
control groups, the air handler in the room went off and temperature and
humidity increased.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6">Solution to Exercise 4</h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" data-bs-parent="#accordionSolution6" aria-labelledby="headingSolution6">
<div class="accordion-body">

</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Replication, randomization and blocking determine the validity and
usefulness of an experiment.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-04-statistical-data-analysis"><p>Content from <a href="04-statistical-data-analysis.html">Statistics in Data Analysis</a></p>
<hr>
<p>Last updated on 2024-04-09 |
        
        <a href="https://github.com/smcclatchy/statistical-experimental-design/edit/main/episodes/04-statistical-data-analysis.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can information be extracted and communicated from experimental
data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Plotting reveals information in the data.</li>
<li>Statistical significance testing compares experimental data obtained
to probability distributions of data that might also be possible.</li>
<li>A probability distribution is a mathematical function that gives the
probabilities of different possible outcomes for an experiment.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="a-picture-is-worth-a-thousand-words"><h2 class="section-heading">A picture is worth a thousand words<a class="anchor" aria-label="anchor" href="#a-picture-is-worth-a-thousand-words"></a>
</h2>
<hr class="half-width">
<p>To motivate this next section on statistics, we start with an example
of human variability. This 1975 living histogram of women from the
University of Wisconsin Madison shows variability in a natural
population.</p>
<figure><img src="fig/joiner-living-histogram-heights.png" alt="living histogram of female student heights" class="figure mx-auto d-block"></figure><p><a href="https://personal.psu.edu/drh20/talks/joiner_living_histograms.pdf" class="external-link">B.
Joiner, Int’l Stats Review, 1975</a></p>
<div id="exercise-1-a-living-histogram" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1-a-living-histogram" class="callout-inner">
<h3 class="callout-title">Exercise 1: A living histogram<a class="anchor" aria-label="anchor" href="#exercise-1-a-living-histogram"></a>
</h3>
<div class="callout-content">
<p>From the living histogram, can you estimate by eye<br>
1). the mean and median heights of this sample of women?<br>
2). the spread of the data? Estimate either standard deviation or
variance by eye. If you’re not sure how to do this, think about how you
would describe the spread of the data from the mean. You do not need to
calculate a statistic.<br>
3). any outliers? Estimate by eye - don’t worry about
calculations.<br>
4). What do you predict would happen to mean, median, spread and
outliers if an equal number of men were added to the histogram?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Solution to Exercise 1</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>1). Mean and median are two measures of the center of the data. The
median is the 50th% of the data with half the women above this value and
the other half below. There are approximately 100 students total. Fifty
of them appear to be above 5 feet 5 inches and fifty of them appear to
be below 5’5”. The median is not influenced by extreme values
(outliers), but the mean value is. While there are some very tall and
very short people, the bulk of them appear to be centered around a mean
of 5 foot 5 inches with a somewhat longer right tail to the histogram.
2). If the mean is approximately 5’5” and the distribution appears
normal (bell-shaped), then we know that approximately 68% of the data
lies within one standard deviation (sd) of the mean and ~95% lies within
two sd’s. If there are ~100 people in the sample, 95% of them lie
between 5’0” and 5’10” (2 sd’s = 5” above and 5” below the mean). One
standard deviation then would be about 5”/2 = 2.5” from the mean of
5’5”. So 68% of the data (~68 people) lie within 5 feet 2.5 inches and 5
feet 7.5 inches. 3). There are some very tall and very short people but
it’s not clear whether they are outliers. Outliers deviate significantly
from expected values, specifically by more than 3 standard deviations in
a normal distribution. Values that are greater than 3 sd’s (7.5”) above
or below the mean could be considered outliers. Outliers would then be
shorter than 4 feet 7.5 inches or taller than 6 feet 2.5 inches. The
shortest are 4 feet 9 inches and the tallest 6’ 0 inches. There are no
outliers in this sample because all heights fall within 3 sd’s. 4).
Average heights for men are greater than average heights for women, so
you could expect that a random sample of 100 men would increase the
average height of the sample of 200 students. The mean would shift to
the right of the distribution toward taller heights, as would the
median.</p>
</div>
</div>
</div>
</div>
</section><section id="the-first-step-in-data-analysis-plot-the-data"><h2 class="section-heading">The first step in data analysis: plot the data!<a class="anchor" aria-label="anchor" href="#the-first-step-in-data-analysis-plot-the-data"></a>
</h2>
<hr class="half-width">
<p>A picture is worth a thousand words, and a picture of your data could
reveal important information that can guide you forward. So first, plot
the data!</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read in the simulated heart rate data</span></span>
<span><span class="va">heart_rate</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/heart_rate.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># take a random sample of 100 and create a histogram</span></span>
<span><span class="co"># first set the seed for the random number generator</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">sample100</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="va">heart_rate</span><span class="op">$</span><span class="va">heart_rate</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu">hist</span><span class="op">(</span><span class="va">sample100</span>, xlab <span class="op">=</span> <span class="st">"resting heart rate for 100 participants"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/04-statistical-data-analysis-rendered-unnamed-chunk-3-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="exercise-2-what-does-this-picture-tell-you-about-resting-heart-rates" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-2-what-does-this-picture-tell-you-about-resting-heart-rates" class="callout-inner">
<h3 class="callout-title">Exercise 2: What does this picture tell you
about resting heart rates?<a class="anchor" aria-label="anchor" href="#exercise-2-what-does-this-picture-tell-you-about-resting-heart-rates"></a>
</h3>
<div class="callout-content">
<p>Do the data appear to be normally distributed? Why does this matter?
Do the left and right tails of the data seem to mirror each other or
not? Are there gaps in the data? Are there large clusters of similar
heart rate values in the data? Are there apparent outliers? What message
do the data deliver in this histogram?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Solution to Exercise 2</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">

</div>
</div>
</div>
</div>
<p>Now create a boxplot of the same sample data.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">boxplot</span><span class="op">(</span><span class="va">sample100</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/04-statistical-data-analysis-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="exercise-3-what-does-this-boxplot-tell-you-about-resting-heart-rates" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-3-what-does-this-boxplot-tell-you-about-resting-heart-rates" class="callout-inner">
<h3 class="callout-title">Exercise 3: What does this boxplot tell you
about resting heart rates?<a class="anchor" aria-label="anchor" href="#exercise-3-what-does-this-boxplot-tell-you-about-resting-heart-rates"></a>
</h3>
<div class="callout-content">
<p>What does the box signify? What does horizontal black line dividing
the box signify? Are there apparent outliers? How does the boxplot
relate to the histogram? What message do the data deliver in this
boxplot?</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Solution to Exercise 3</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">

</div>
</div>
</div>
</div>
<p>Plotting the data can identify unusual response measurements
(<strong>outliers</strong>), reveal relationships between variables, and
guide further statistical analysis. When data are not normally
distributed (bell-shaped and symmetrical), many of the statistical
methods typically used will not perform well. In these cases the data
can be transformed to a more symmetrical bell-shaped curve.</p>
</section><section id="random-variables"><h2 class="section-heading">Random variables<a class="anchor" aria-label="anchor" href="#random-variables"></a>
</h2>
<hr class="half-width">
<p>The Generation 100 study aims to determine whether high-intensity
exercise in elderly adults affects lifespan and healthspan.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># heart_rate ~ exercise_group is a formula indicating that the response (heart</span></span>
<span><span class="co"># rate) is dependent on the treatment (exercise group)</span></span>
<span><span class="fu">boxplot</span><span class="op">(</span><span class="va">heart_rate</span> <span class="op">~</span> <span class="va">exercise_group</span>, data <span class="op">=</span> <span class="va">heart_rate</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/04-statistical-data-analysis-rendered-boxplot-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="exercise-4-comparing-two-groups---control-vs.-high-intensity" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-4-comparing-two-groups---control-vs.-high-intensity" class="callout-inner">
<h3 class="callout-title">Exercise 4: Comparing two groups - control
vs. high intensity<a class="anchor" aria-label="anchor" href="#exercise-4-comparing-two-groups---control-vs.-high-intensity"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Does there appear to be a significant heart rate difference between
the control and high intensity exercise groups? How would you know?</li>
<li>Do any of the data overlap between the two boxplots?</li>
<li>Can you know which exercise group a person belongs to just by
knowing their heart rate? For example, for a heart rate of 80 could you
say with certainty that a person belongs to one group or the other?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">Solution to Exercise 4</h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>There appears to be a trend of lower heart rate in the
high-intensity exercise group, however, we can’t say whether or not it
is significant without performing statistical tests.</li>
<li>There is considerable overlap between the two groups, which shows
that there is considerable variability in the data.</li>
<li>Someone with a heart rate of 80 could belong to any group. When
considering significance of heart rate differences between the two
groups we don’t look at individuals, rather, we look at averages between
the two groups.</li>
</ol>
</div>
</div>
</div>
</div>
<p>The boxplots above show a trend of lower heart rate in the
high-intensity exercise group and higher heart rate in the control
exercise group. There is inherent variability in heart rate in both
groups however, which is to be expected. That variability appears in the
box and whisker lengths of the boxplots, along with any outliers that
appear as hollow circles outside of the whisker length. This variability
in heart rate measurements also means that the boxplots overlap between
the two groups, making it difficult to determine whether there is a
significant difference in mean heart rate between the groups.</p>
<p>We can calculate the difference in means between the two groups to
answer the question about exercise intensity.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate the means of the two groups</span></span>
<span><span class="co"># load the tidyverse library to write more easily interpreted code</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span></span>
<span><span class="va">HI</span> <span class="op">&lt;-</span> <span class="va">heart_rate</span> <span class="op">%&gt;%</span> <span class="fu">filter</span><span class="op">(</span><span class="va">exercise_group</span> <span class="op">==</span> <span class="st">"high intensity"</span><span class="op">)</span></span>
<span><span class="va">control</span> <span class="op">&lt;-</span> <span class="va">heart_rate</span> <span class="op">%&gt;%</span> <span class="fu">filter</span><span class="op">(</span><span class="va">exercise_group</span> <span class="op">==</span> <span class="st">"control"</span><span class="op">)</span></span>
<span><span class="va">meanDiff</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">control</span><span class="op">$</span><span class="va">heart_rate</span><span class="op">)</span> <span class="op">-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">HI</span><span class="op">$</span><span class="va">heart_rate</span><span class="op">)</span></span></code></pre>
</div>
<p>The actual difference in mean heart rates between the two groups is
2.19. Another way of stating this is that the high-intensity group had a
mean heart rate that was 3 percent lower than the control group. This is
the <em>observed effect size</em>.</p>
<p>So are we done now? Does this difference support the alternative
hypothesis that there is a significant difference in mean heart rates?
Or does it fail to reject the null hypothesis of no significant
difference? Why do we need p-values and confidence intervals if we have
evidence we think supports our claim? The reason is that the mean values
are <strong>random variables</strong> that can take many different
values. We are working with two samples of elderly Norwegians, not the
entire population of elderly Norwegians. The means are
<strong>estimates</strong> of the true mean heart rate of the entire
population, a number that we can never know because we can’t access the
entire population of elders. The sample means will vary with every
sample we take from the population. To demonstrate this, let’s take a
sample from each exercise group and calculate the difference in means
for those samples.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate the sample mean of 100 people in each group</span></span>
<span><span class="va">HI100</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="fu">sample</span><span class="op">(</span><span class="va">HI</span><span class="op">$</span><span class="va">heart_rate</span>, size <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">control100</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="fu">sample</span><span class="op">(</span><span class="va">control</span><span class="op">$</span><span class="va">heart_rate</span>, size <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">control100</span> <span class="op">-</span> <span class="va">HI100</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2.674469</code></pre>
</div>
<p>Now take another sample of 100 from each group and calculate the
difference in means.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate the sample mean of 100 people in each group</span></span>
<span><span class="va">HI100</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="fu">sample</span><span class="op">(</span><span class="va">HI</span><span class="op">$</span><span class="va">heart_rate</span>, size <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">control100</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="fu">sample</span><span class="op">(</span><span class="va">control</span><span class="op">$</span><span class="va">heart_rate</span>, size <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">control100</span> <span class="op">-</span> <span class="va">HI100</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1.01351</code></pre>
</div>
<p>Are the differences in sample means the same? We can repeat this
sampling again and again, and each time arrive at a different value. The
sample means are a random variable, meaning that they can take on any
number of different values. Since they are random variables, the
difference between the means (the <em>observed effect size</em>) is also
a random variable.</p>
<p>Supposing we did have access to the entire population of elderly
Norwegians. Can we determine the mean resting heart rate for the entire
population, rather than just for samples of the population? Imagine that
you have measured the resting heart rate of the entire population of
elders 70 or older, not just the 1,567 from the Generation 100 study. In
practice we would never have access to the entire population, so this is
a thought exercise.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read in the heart rates of the entire population of all elderly people</span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="fu">rbind</span><span class="op">(</span><span class="va">HI</span>, <span class="va">control</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># sample 100 of them and calculate the mean three times</span></span>
<span><span class="fu">mean</span><span class="op">(</span><span class="fu">sample</span><span class="op">(</span><span class="va">population</span><span class="op">$</span><span class="va">heart_rate</span>, size <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 68.95477</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="fu">sample</span><span class="op">(</span><span class="va">population</span><span class="op">$</span><span class="va">heart_rate</span>, size <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 68.00007</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="fu">sample</span><span class="op">(</span><span class="va">population</span><span class="op">$</span><span class="va">heart_rate</span>, size <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 68.90681</code></pre>
</div>
<p>Notice how the mean changes each time you sample. We can continue to
do this many times to learn about the distribution of this random
variable. Comparing the data obtained to a <em>probability
distribution</em> of data that might have been obtained can help to
answer questions about the effects of exercise intensity on heart
rate.</p>
</section><section id="the-null-hypothesis"><h2 class="section-heading">The null hypothesis<a class="anchor" aria-label="anchor" href="#the-null-hypothesis"></a>
</h2>
<hr class="half-width">
<p>Now let’s return to the mean difference between treatment groups. How
do we know that this difference is due to the exercise? What happens if
all do the same exercise intensity? Will we see a difference as large as
we saw between the two treatment groups? This is called the null
hypothesis. The word null reminds us to be skeptical and to entertain
the possibility that there is no difference.</p>
<p>Because we have access to the population, we can randomly sample 100
controls to observe as many of the differences in means when exercise
intensity has no effect. We can give everyone the same exercise plan and
then record the difference in means between two randomly split groups of
100 and 100.</p>
<p>Here is this process written in R code:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 100 controls</span></span>
<span><span class="va">control</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="va">population</span><span class="op">$</span><span class="va">heart_rate</span>, <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## another 100 controls that we pretend are on a high-intensity regimen</span></span>
<span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="va">population</span><span class="op">$</span><span class="va">heart_rate</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu">mean</span><span class="op">(</span><span class="va">treatment</span><span class="op">)</span> <span class="op">-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">control</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1.340398</code></pre>
</div>
<p>Now let’s find the sample mean of 100 participants from each group
10,000 times.</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu">replicate</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10000</span>, <span class="fu">mean</span><span class="op">(</span><span class="fu">sample</span><span class="op">(</span><span class="va">population</span><span class="op">$</span><span class="va">heart_rate</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">control</span> <span class="op">&lt;-</span> <span class="fu">replicate</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10000</span>, <span class="fu">mean</span><span class="op">(</span><span class="fu">sample</span><span class="op">(</span><span class="va">population</span><span class="op">$</span><span class="va">heart_rate</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">null</span> <span class="op">&lt;-</span> <span class="va">treatment</span> <span class="op">-</span> <span class="va">control</span></span>
<span><span class="fu">hist</span><span class="op">(</span><span class="va">null</span><span class="op">)</span></span>
<span><span class="fu">abline</span><span class="op">(</span>v<span class="op">=</span><span class="va">meanDiff</span>, col<span class="op">=</span><span class="st">"red"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/04-statistical-data-analysis-rendered-unnamed-chunk-10-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p><code>null</code> contains the differences in means between the two
groups sampled 10,000 times each. The value of the observed difference
in means between the two groups, <code>meanDiff</code>, is shown as a
vertical red line. The values in <code>null</code> make up the
<strong>null distribution</strong>. How many of these differences are
greater than the observed difference in means between the actual
treatment and control groups?</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="va">null</span> <span class="op">&gt;=</span> <span class="va">meanDiff</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.0596</code></pre>
</div>
<p>Approximately 6% of the 10,000 simulations are greater than the
observed difference in means. We can expect then that we will see a
difference in means approximately 6% of the time even if there is no
effect of exercise on heart rate. This is known as a
<strong>p-value</strong>.</p>
<div id="exercise-5-what-does-a-p-value-mean" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-5-what-does-a-p-value-mean" class="callout-inner">
<h3 class="callout-title">Exercise 5: What does a p-value mean?<a class="anchor" aria-label="anchor" href="#exercise-5-what-does-a-p-value-mean"></a>
</h3>
<div class="callout-content">
<p>What does this p-value tell us about the difference in means between
the two groups? How can we interpret this value? What does it say about
the significance of the difference in mean values?</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">Solution to Exercise 5</h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">

</div>
</div>
</div>
</div>
<p>P-values are often misinterpreted as the probability that, in this
example, high-intensity and control exercise result in the same average
heart rate. However, “high-intensity and control exercise result in the
same average heart rate” is not a <strong>random variable</strong> like
the number of heads or tails in 10 flips of a coin. It’s a statement
that doesn’t have a <strong>probability distribution</strong>, so you
can’t make probability statements about it. The p-value summarizes the
comparison between our data and the data we might have obtained from a
probability distribution if there were no difference in mean heart
rates. Specifically, the p-value tells us how far out on the tail of
that distribution the data we got falls. The smaller the p-value, the
greater the disparity between the data we have and the data distribution
that might have been. To understand this better, we’ll explore
probability distributions next.</p>
</section><section id="probability-and-probability-distributions"><h2 class="section-heading">Probability and probability distributions<a class="anchor" aria-label="anchor" href="#probability-and-probability-distributions"></a>
</h2>
<hr class="half-width">
<p>Suppose you have measured the resting heart rate of the entire
population of elderly Norwegians 70 or older, not just the 1,567 from
the Generation 100 study. Imagine you need to describe all of these
numbers to someone who has no idea what resting heart rate is. Imagine
that all the measurements from the entire population are contained in
<code>population</code>. We could list out all of the numbers for them
to see or take a sample and show them the sample of heart rates, but
this would be inefficient and wouldn’t provide much insight into the
data. A better approach is to define and visualize a
<strong>distribution</strong>. The simplest way to think of a
distribution is as a compact description of many numbers.</p>
<p>Histograms show us the proportion of values within an interval. Here
is a histogram showing all resting heart rates for the entire population
70 and older.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">population</span> <span class="op">%&gt;%</span> <span class="fu">ggplot</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span><span class="va">heart_rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="fig/04-statistical-data-analysis-rendered-population_hist-1.png" style="display: block; margin: auto;" class="figure">
Showing this plot is much more informative and easier to interpret than
a long table of numbers. With this histogram we can approximate the
number of individuals in any given interval. For example, there are
approximately 40 individuals (~2.6%) with a resting heart rate greater
than 90, and another 38 individuals (~2.4%) with a resting heart rate
below 50.</p>
<p>The histogram above approximates one that is very common in nature:
the bell curve, also known as the <strong>normal distribution</strong>
or Gaussian distribution.</p>
<figure><img src="fig/04-statistical-data-analysis-rendered-standard_normal_dist-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The curve shown above is an example of a <strong>probability density
function</strong> that defines a normal distribution. The y-axis is the
<strong>probability density</strong>, and the total area under the curve
sums to 1.0 on the y-axis. The x-axis denotes a variable <em>z</em> that
by statistical convention has a standard normal distribution. If you
draw a random value from a normal distribution, the probability that the
value falls in a particular interval, say from <em>a</em> to <em>b</em>,
is given by the area under the curve between <em>a</em> and <em>b</em>.
When the histogram of a list of numbers approximates the normal
distribution, we can use a convenient mathematical formula to
approximate the proportion of values or outcomes in any given interval.
That formula is conveniently stored in the function
<code>pnorm</code></p>
<p>If the normal approximation holds for our list of data values, then
the mean and variance (spread) of the data can be used. For example,
when we noticed that ~ 6% of the values in the null distribution were
greater than <code>meanDiff</code>, the mean difference between control
and high-intensity groups. We can compute the proportion of values below
a value <code>x</code> with <code>pnorm(x, mu, sigma)</code> where
<code>mu</code> is the mean and <code>sigma</code> the standard
deviation (the square root of the variance).</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">-</span> <span class="fu">pnorm</span><span class="op">(</span><span class="va">meanDiff</span>, mean<span class="op">=</span><span class="fu">mean</span><span class="op">(</span><span class="va">null</span><span class="op">)</span>, sd<span class="op">=</span><span class="fu">sd</span><span class="op">(</span><span class="va">null</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.05824075</code></pre>
</div>
<p>A useful characteristic of this approximation is that we only need to
know <code>mu</code> and <code>sigma</code> to describe the entire
distribution. From this, we can compute the proportion of values in any
interval.</p>
<p>Real-world populations may be approximated by the mathematical ideal
of the normal distribution. Repeat the sampling we did earlier and
produce a new histogram of the sample.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample100</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="va">heart_rate</span><span class="op">$</span><span class="va">heart_rate</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu">hist</span><span class="op">(</span><span class="va">sample100</span>, xlab <span class="op">=</span> <span class="st">"resting heart rate for 100 participants"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/04-statistical-data-analysis-rendered-unnamed-chunk-12-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="exercise-6-sampling-from-a-population" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-6-sampling-from-a-population" class="callout-inner">
<h3 class="callout-title">Exercise 6: Sampling from a population<a class="anchor" aria-label="anchor" href="#exercise-6-sampling-from-a-population"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Does the sample appear to be normally distributed?<br>
</li>
<li>Can you estimate the mean resting heart rate by eye?<br>
</li>
<li>What is the sample mean using R (hint: use
<code>mean()</code>)?<br>
</li>
<li>Can you estimate the sample standard deviation by eye? Hint: if
normally distributed, 68% of the data will lie within one standard
deviation of the mean and 95% will lie within 2 standard
deviations.<br>
</li>
<li>What is the sample standard deviation using R (hint: use
<code>sd()</code>)?<br>
</li>
<li>Estimate the number of people with a resting heart rate between 60
and 70.<br>
</li>
<li>What message does the sample deliver about the population from which
it was drawn?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6">Solution to Exercise 6</h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" data-bs-parent="#accordionSolution6" aria-labelledby="headingSolution6">
<div class="accordion-body">

</div>
</div>
</div>
</div>
</section><section id="statistical-significance-testing-the-t-test"><h2 class="section-heading">Statistical significance testing: the t-test<a class="anchor" aria-label="anchor" href="#statistical-significance-testing-the-t-test"></a>
</h2>
<hr class="half-width">
<p>Significance testing can answer questions about differences between
the two groups in light of inherent variability in heart rate
measurements. What does it mean that a difference is statistically
significant? We can eye plots like the boxplots above and see a
difference, however, we need something more objective than eyeballs to
claim a significant difference. A t-test will report whether the
difference in mean values between the two groups is significant. The
<strong>null hypothesis</strong> would state that there is no difference
in mean values, while the <strong>alternative hypothesis</strong> states
that there is a difference in the means of the two
<strong>samples</strong> from the whole <strong>population</strong> of
elders in Norway.</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># provide a formula stating that heart rate is dependent on exercise intensity</span></span>
<span><span class="fu">t.test</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">heart_rate</span> <span class="op">~</span> <span class="va">exercise_group</span>, data <span class="op">=</span> <span class="va">population</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Welch Two Sample t-test

data:  heart_rate by exercise_group
t = 4.3077, df = 1558.6, p-value = 1.753e-05
alternative hypothesis: true difference in means between group control and group high intensity is not equal to 0
95 percent confidence interval:
 1.190989 3.182362
sample estimates:
       mean in group control mean in group high intensity 
                    70.72745                     68.54078 </code></pre>
</div>
</section><section id="the-perils-of-p-values"><h2 class="section-heading">The perils of p-values<a class="anchor" aria-label="anchor" href="#the-perils-of-p-values"></a>
</h2>
<hr class="half-width">
<p>You can access the p-value alone from the t-test by saving the
results and accessing individual elements with the <code>$</code>
operator.</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># save the t-test result and access the p-value alone</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">t.test</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">heart_rate</span> <span class="op">~</span> <span class="va">exercise_group</span>, data <span class="op">=</span> <span class="va">population</span><span class="op">)</span></span>
<span><span class="va">result</span><span class="op">$</span><span class="va">p.value</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1.752533e-05</code></pre>
</div>
<p>The p-value indicates a statistically significant difference between
exercise groups. It is not enough, though, to report only a p-value. The
p-value says nothing about the effect size (the observed difference). If
the effect size was tiny, say .01 or less, would it matter how small the
p-value is? The effect is negligible, so the p-value does nothing to
demonstrate practical relevance or meaning. We should question how large
the effect is. The p-value can only tell us whether an effect
exists.</p>
</section><section id="confidence-intervals"><h2 class="section-heading">Confidence intervals<a class="anchor" aria-label="anchor" href="#confidence-intervals"></a>
</h2>
<hr class="half-width">
<p>P-values report statistical significance of an effect, but what we
want is scientific significance. Confidence intervals include estimates
of the effect size and uncertainty associated with these estimates.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># access the confidence interval</span></span>
<span><span class="va">result</span><span class="op">$</span><span class="va">conf.int</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1.190989 3.182362
attr(,"conf.level")
[1] 0.95</code></pre>
</div>
<p>The confidence interval states that the true difference in means is
between 1.1909892 and 3.1823623. A 95% confidence interval states that
95% of random intervals will contain the true value. This is not the
same as saying that there is a 95% chance that the true value falls
within the interval.</p>
<div id="exercise-7-how-and-when-to-set-up-blocks" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-7-how-and-when-to-set-up-blocks" class="callout-inner">
<h3 class="callout-title">Exercise 7: How and when to set up blocks<a class="anchor" aria-label="anchor" href="#exercise-7-how-and-when-to-set-up-blocks"></a>
</h3>
<div class="callout-content">
<p>For each statement, explain to a partner why you believe the
statement is true or untrue.</p>
<ol style="list-style-type: decimal">
<li>A p-value of .02 means that there is only a 2% chance that
high-intensity and control exercise result in the same average heart
rate.</li>
<li>A p-value of .02 demonstrates that there is a meaningful difference
in average heart rates between the two groups.</li>
<li>A 95% confidence interval has a 95% chance of containing the true
difference in means.</li>
<li>A confidence interval should be reported along with the
p-value.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7">Solution to Exercise 7</h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" data-bs-parent="#accordionSolution7" aria-labelledby="headingSolution7">
<div class="accordion-body">

</div>
</div>
</div>
</div>
</section><section id="sample-sizes-and-power-curves"><h2 class="section-heading">Sample sizes and power curves<a class="anchor" aria-label="anchor" href="#sample-sizes-and-power-curves"></a>
</h2>
<hr class="half-width"></section><section id="comparing-standard-deviations"><h2 class="section-heading">Comparing standard deviations<a class="anchor" aria-label="anchor" href="#comparing-standard-deviations"></a>
</h2>
<hr class="half-width">
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Plotting and significance testing describe patterns in the data and
quantify effects against random variation.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-05-complete-random-design"><p>Content from <a href="05-complete-random-design.html">Completely Randomized Designs</a></p>
<hr>
<p>Last updated on 2024-04-02 |
        
        <a href="https://github.com/smcclatchy/statistical-experimental-design/edit/main/episodes/05-complete-random-design.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is a completely randomized design (CRD)?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>CRD is the simplest experimental design.</li>
<li>In CRD, treatments are assigned randomly to experimental units.</li>
<li>CRD assumes that the experimental units are relatively homogeneous
or similar.</li>
<li>CRD doesn’t remove or account for systematic differences among
experimental units.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="a-single-qualitative-factor"><h2 class="section-heading">A single qualitative factor<a class="anchor" aria-label="anchor" href="#a-single-qualitative-factor"></a>
</h2>
<hr class="half-width"></section><section id="analysis-of-variance-anova"><h2 class="section-heading">Analysis of variance (ANOVA)<a class="anchor" aria-label="anchor" href="#analysis-of-variance-anova"></a>
</h2>
<hr class="half-width"></section><section id="equal-variances-and-normality"><h2 class="section-heading">Equal variances and normality<a class="anchor" aria-label="anchor" href="#equal-variances-and-normality"></a>
</h2>
<hr class="half-width"></section><section id="inference"><h2 class="section-heading">Inference<a class="anchor" aria-label="anchor" href="#inference"></a>
</h2>
<hr class="half-width"></section><section id="a-single-quantitative-factor"><h2 class="section-heading">A single quantitative factor<a class="anchor" aria-label="anchor" href="#a-single-quantitative-factor"></a>
</h2>
<hr class="half-width"></section><section id="design-issues"><h2 class="section-heading">Design issues<a class="anchor" aria-label="anchor" href="#design-issues"></a>
</h2>
<hr class="half-width">
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>CRD is a simple design that can be used when experimental are
homogeneous.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-06-complete-random-design-multitreatment-factors"><p>Content from <a href="06-complete-random-design-multitreatment-factors.html">Completely Randomized Design with More than One Treatment Factor</a></p>
<hr>
<p>Last updated on 2024-04-02 |
        
        <a href="https://github.com/smcclatchy/statistical-experimental-design/edit/main/episodes/06-complete-random-design-multitreatment-factors.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How is a CRD with more than one treatment factor designed and
analyzed?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>.</li>
<li>.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>.</li>
</ul>
</div>
</div>
</div></section><section id="aio-07-complete-random-block"><p>Content from <a href="07-complete-random-block.html">Randomized Complete Block Designs</a></p>
<hr>
<p>Last updated on 2024-04-02 |
        
        <a href="https://github.com/smcclatchy/statistical-experimental-design/edit/main/episodes/07-complete-random-block.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is randomized complete block design?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>A randomized complete block design randomizes treatments to
experimental units within the block.</li>
<li>Blocking increases the precision of treatment comparisons.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="design-issues"><h2 class="section-heading">Design issues<a class="anchor" aria-label="anchor" href="#design-issues"></a>
</h2>
<hr class="half-width">
<p>Imagine that you want to evaluate the effect of different doses of a
new drug on the proliferation of cancer cell lines in vitro. You use
four different cancer cell lines because you would like the results to
generalize to many types of cell lines. Divide each of the cell lines
into four treatment groups, each with the same number of cells. Each
treatment group receives a different dose of the drug for five
consecutive days.</p>
<p>Group 1: Control (no drug)<br>
Group 2: Low dose (10 μM) Group 3: Medium dose (50 μM) Group 4: High
dose (100 μM)</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create treatment levels</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"low"</span>, <span class="st">"medium"</span>, <span class="st">"high"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create random orderings of the treatment levels</span></span>
<span><span class="va">block1</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="va">f</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">block2</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="va">f</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">block3</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="va">f</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">block4</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="va">f</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">block1</span>, <span class="va">block2</span>, <span class="va">block3</span>, <span class="va">block4</span><span class="op">)</span></span>
<span><span class="va">block</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"cellLine1"</span>, <span class="st">"cellLine2"</span>, <span class="st">"cellLine3"</span>, <span class="st">"cellLine4"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dishnum</span> <span class="op">&lt;-</span> <span class="fu">rep</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">plan</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span>cellLine <span class="op">=</span> <span class="va">block</span>, DishNumber <span class="op">=</span> <span class="va">dishnum</span>, treatment <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span></span>
<span><span class="va">plan</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    cellLine DishNumber treatment
1  cellLine1          1      high
2  cellLine1          2       low
3  cellLine1          3   control
4  cellLine1          4    medium
5  cellLine2          1   control
6  cellLine2          2    medium
7  cellLine2          3      high
8  cellLine2          4       low
9  cellLine3          1      high
10 cellLine3          2    medium
11 cellLine3          3   control
12 cellLine3          4       low
13 cellLine4          1      high
14 cellLine4          2       low
15 cellLine4          3    medium
16 cellLine4          4   control</code></pre>
</div>
<p>When analyzing a random complete block design, the effect of the
block is included in the equation along with the effect of the
treatment.</p>
</section><section id="randomized-block-design-with-a-single-replication"><h2 class="section-heading">Randomized block design with a single replication<a class="anchor" aria-label="anchor" href="#randomized-block-design-with-a-single-replication"></a>
</h2>
<hr class="half-width"></section><section id="sizing-a-randomized-block-experiment"><h2 class="section-heading">Sizing a randomized block experiment<a class="anchor" aria-label="anchor" href="#sizing-a-randomized-block-experiment"></a>
</h2>
<hr class="half-width"></section><section id="true-replication"><h2 class="section-heading">True replication<a class="anchor" aria-label="anchor" href="#true-replication"></a>
</h2>
<hr class="half-width"></section><section id="balanced-incomplete-block-designs"><h2 class="section-heading">Balanced incomplete block designs<a class="anchor" aria-label="anchor" href="#balanced-incomplete-block-designs"></a>
</h2>
<hr class="half-width">
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Replication, randomization and blocking determine the validity and
usefulness of an experiment.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-08-repeated-measures-design"><p>Content from <a href="08-repeated-measures-design.html">Repeated Measures Designs</a></p>
<hr>
<p>Last updated on 2024-04-02 |
        
        <a href="https://github.com/smcclatchy/statistical-experimental-design/edit/main/episodes/08-repeated-measures-design.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is a repeated measures design?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>A repeated measures design measures the response of experimental
units repeatedly during the study.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="drug-effect-on-heart-rate"><h2 class="section-heading">Drug effect on heart rate<a class="anchor" aria-label="anchor" href="#drug-effect-on-heart-rate"></a>
</h2>
<hr class="half-width"></section><section id="among-subject-vs.-within-subject-variability"><h2 class="section-heading">Among-subject vs. within-subject variability<a class="anchor" aria-label="anchor" href="#among-subject-vs.-within-subject-variability"></a>
</h2>
<hr class="half-width">
<p>Each subject can be its own control</p>
</section><section id="crossover-design-for-heart-rate"><h2 class="section-heading">crossover design for heart rate<a class="anchor" aria-label="anchor" href="#crossover-design-for-heart-rate"></a>
</h2>
<hr class="half-width">
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>.</li>
</ul>
</div>
</div>
</div>
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/smcclatchy/statistical-experimental-design/edit/main/README.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/smcclatchy/statistical-experimental-design/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/smcclatchy/statistical-experimental-design/" class="external-link">Source</a></p>
				<p><a href="https://github.com/smcclatchy/statistical-experimental-design/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.3" class="external-link">sandpaper (0.16.3)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.4" class="external-link">pegboard (0.7.4)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.1" class="external-link">varnish (1.0.1)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://smcclatchy.github.io/statistical-experimental-design/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://smcclatchy.github.io/statistical-experimental-design/aio.html",
  "identifier": "https://smcclatchy.github.io/statistical-experimental-design/aio.html",
  "dateCreated": "2023-04-03",
  "dateModified": "2024-04-09",
  "datePublished": "2024-04-09"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

